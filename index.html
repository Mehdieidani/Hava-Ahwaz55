<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ÙˆØ¶Ø¹ÛŒØª Ø¢Ø¨â€ŒÙˆÙ‡ÙˆØ§</title>
  <style>
    body {
      margin: 0;
      font-family: 'Vazir', sans-serif;
      background: #121212;
      color: #fff;
      direction: rtl;
    }
    header {
      background: #1e1e1e;
      padding: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    #cityInput {
      width: 60%;
      padding: 8px;
      font-size: 16px;
      border: none;
      border-radius: 4px;
    }
    #searchBtn {
      padding: 8px 12px;
      background: #1976d2;
      border: none;
      color: white;
      border-radius: 4px;
      margin-right: 10px;
    }
    #langToggle {
      background: #333;
      border: none;
      color: white;
      padding: 8px;
      border-radius: 4px;
    }
    .ad-box {
      background: #272727;
      margin: 10px;
      padding: 10px;
      border: 1px solid #444;
      border-radius: 6px;
      text-align: center;
    }
    .ad-box a {
      display: inline-block;
      margin-top: 8px;
      padding: 10px 20px;
      background: #00c853;
      color: #fff;
      text-decoration: none;
      font-weight: bold;
      border-radius: 6px;
    }
    .weather-section {
      padding: 10px;
    }
    .weather-card {
      background: #1f1f1f;
      margin: 10px 0;
      padding: 12px;
      border-radius: 6px;
      box-shadow: 0 0 5px #000;
    }
    .weather-card h3 {
      margin: 0 0 10px 0;
    }
    .hourly-details {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .hour-card {
      flex: 1 1 45%;
      background: #2a2a2a;
      padding: 10px;
      border-radius: 6px;
      text-align: center;
    }
    .hour-card img {
      width: 50px;
    }
  </style>
</head>
<body>
  <header>
    <input type="text" id="cityInput" placeholder="Ù†Ø§Ù… Ø´Ù‡Ø± ÛŒØ§ Ø±ÙˆØ³ØªØ§ (Ù…Ø«Ù„Ø§Ù‹ Ø§Ù‡ÙˆØ§Ø² ÛŒØ§ Kazemi Do)" />
    <button id="searchBtn">Ø¬Ø³ØªØ¬Ùˆ</button>
    <button id="langToggle">AR</button>
  </header>

  <div class="ad-box">
    <p>ğŸ“ ØªÙ…Ø§Ø³ ÙÙˆØ±ÛŒ Ø¨Ø§ Ú©Ø§Ø±Ø´Ù†Ø§Ø³</p>
    <a href="tel:09332356547">ØªÙ…Ø§Ø³: 09332356547</a>
  </div>

  <div class="weather-section">
    <h2 id="title">ÙˆØ¶Ø¹ÛŒØª Ø¢Ø¨â€ŒÙˆÙ‡ÙˆØ§</h2>
    <h3 id="cityName">Ø´Ù‡Ø±: Ø§Ù‡ÙˆØ§Ø²</h3>
    <div id="dailyForecast"></div>
  </div>

  <script>
    const API_KEY = "dc9c93f51cdd375d459483c2a9f86d88";
    let currentLang = "fa";

    const labels = {
      fa: {
        title: "ÙˆØ¶Ø¹ÛŒØª Ø¢Ø¨â€ŒÙˆÙ‡ÙˆØ§",
        searchPlaceholder: "Ù†Ø§Ù… Ø´Ù‡Ø± ÛŒØ§ Ø±ÙˆØ³ØªØ§ (Ù…Ø«Ù„Ø§Ù‹ Ø§Ù‡ÙˆØ§Ø² ÛŒØ§ Kazemi Do)",
        call: "ğŸ“ ØªÙ…Ø§Ø³ Ø¨Ø§ 09332356547",
        notFound: "Ø´Ù‡Ø± Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯.",
        forecast: "Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡"
      },
      ar: {
        title: "Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù‚Ø³",
        searchPlaceholder: "Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø£Ùˆ Ø§Ù„Ù‚Ø±ÙŠØ©",
        call: "ğŸ“ Ø§ØªØµÙ„ Ø¨Ù€ 09332356547",
        notFound: "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.",
        forecast: "ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ø·Ù‚Ø³ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©"
      }
    };

    document.getElementById("langToggle").addEventListener("click", () => {
      currentLang = currentLang === "fa" ? "ar" : "fa";
      document.getElementById("title").innerText = labels[currentLang].title;
      document.getElementById("cityInput").placeholder = labels[currentLang].searchPlaceholder;
      document.getElementById("langToggle").innerText = currentLang === "fa" ? "AR" : "FA";
      document.querySelector(".ad-box p").innerText = labels[currentLang].call;
    });

    document.getElementById("searchBtn").addEventListener("click", searchCity);

    async function searchCity() {
      const city = document.getElementById("cityInput").value.trim();
      if (!city) return;
      try {
        const geoRes = await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${city}&limit=1&appid=${API_KEY}`);
        const geoData = await geoRes.json();
        if (!geoData.length) {
          alert(labels[currentLang].notFound);
          return;
        }

        const { lat, lon, name, country } = geoData[0];
        document.getElementById("cityName").innerText = `${name}, ${country}`;

        const weatherRes = await fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&units=metric&lang=${currentLang}&appid=${API_KEY}`);
        const weatherData = await weatherRes.json();

        displayForecast(weatherData);
      } catch (err) {
        alert("Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§ØªØŒ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.");
      }
    }

    function displayForecast(data) {
      const forecastDiv = document.getElementById("dailyForecast");
      forecastDiv.innerHTML = "";

      const days = {};

      data.list.forEach(item => {
        const date = item.dt_txt.split(" ")[0];
        if (!days[date]) days[date] = [];
        days[date].push(item);
      });

      for (const date in days) {
        const dayData = days[date];
        const minTemp = Math.min(...dayData.map(d => d.main.temp_min)).toFixed(1);
        const maxTemp = Math.max(...dayData.map(d => d.main.temp_max)).toFixed(1);
        const desc = dayData[0].weather[0].description;
        const icon = dayData[0].weather[0].icon;

        let hourHtml = "";
        dayData.forEach(h => {
          hourHtml += `
            <div class="hour-card">
              <div><strong>${h.dt_txt.split(" ")[1].slice(0, 5)}</strong></div>
              <img src="https://openweathermap.org/img/wn/${h.weather[0].icon}@2x.png" />
              <div>${h.weather[0].description}</div>
              <div>ğŸŒ¡ Ø¯Ù…Ø§: ${h.main.temp}Â°C</div>
              <div>ğŸ’§ Ø±Ø·ÙˆØ¨Øª: ${h.main.humidity}%</div>
              <div>ğŸ’¨ Ø¨Ø§Ø¯: ${h.wind.speed} m/s</div>
              <div>ğŸ§­ Ø¬Ù‡Øª: ${h.wind.deg}Â°</div>
              <div>ğŸ“‰ ÙØ´Ø§Ø±: ${h.main.pressure} hPa</div>
            </div>
          `;
        });

        forecastDiv.innerHTML += `
          <div class="weather-card">
            <h3>ğŸ“… ${date}</h3>
            <p>ğŸŒ¤ ${desc} | ğŸ”º Ø¨ÛŒØ´ÛŒÙ†Ù‡: ${maxTemp}Â° | ğŸ”» Ú©Ù…ÛŒÙ†Ù‡: ${minTemp}Â°</p>
            <div class="hourly-details">${hourHtml}</div>
          </div>
        `;
      }
    }

    window.onload = () => {
      document.getElementById("cityInput").value = "Ø§Ù‡ÙˆØ§Ø²";
      searchCity();
    };
  </script>
</body>
</html>
