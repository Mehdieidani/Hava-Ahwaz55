<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù‡ÙˆØ§Ø´Ù†Ø§Ø³ÛŒ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Tahoma, sans-serif;
      background-color: #121212;
      color: #fff;
      margin: 0;
      padding: 20px;
      direction: rtl;
    }
    h1 {
      text-align: center;
      margin-bottom: 10px;
    }
    .lang-btn {
      position: fixed;
      top: 10px;
      left: 10px;
      z-index: 999;
    }
    input, button {
      font-size: 16px;
      padding: 8px;
      margin: 5px;
      border-radius: 8px;
      border: none;
    }
    #dailyForecast {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    .forecast-card {
      background: #1f1f1f;
      border: 1px solid #333;
      border-radius: 10px;
      padding: 10px;
      text-align: center;
    }
    .forecast-card img {
      width: 60px;
      height: 60px;
    }
    .forecast-card h3 {
      font-size: 14px;
      margin: 5px 0;
    }
    footer {
      text-align: center;
      margin-top: 30px;
      font-size: 12px;
      color: #aaa;
    }
  </style>
</head>
<body>

<button class="lang-btn" onclick="switchLanguage()">ğŸŒ</button>
<h1 id="title">Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù‡ÙˆØ§Ø´Ù†Ø§Ø³ÛŒ</h1>

<div style="text-align:center;">
  <input type="text" id="cityInput" placeholder="Ù†Ø§Ù… Ø´Ù‡Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..." onkeypress="if(event.key==='Enter') getWeather()">
  <button onclick="getWeather()">Ù†Ù…Ø§ÛŒØ´</button>
</div>

<div id="dailyForecast"></div>

<footer>ØªÙ…Ø§Ù… Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª Â© Mehdi Eidani</footer>

<script>
let lang = "fa";
const apiKey = "dc9c93f51cdd375d459483c2a9f86d88";

function switchLanguage() {
  lang = lang === "fa" ? "ar" : "fa";
  document.documentElement.lang = lang;
  document.documentElement.dir = lang === "fa" ? "rtl" : "rtl";

  document.getElementById("title").innerText =
    lang === "fa" ? "Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù‡ÙˆØ§Ø´Ù†Ø§Ø³ÛŒ" : "ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ø·Ù‚Ø³";
  document.getElementById("cityInput").placeholder =
    lang === "fa" ? "Ù†Ø§Ù… Ø´Ù‡Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..." : "Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©...";
  document.querySelector("button[onclick='getWeather()']").innerText =
    lang === "fa" ? "Ù†Ù…Ø§ÛŒØ´" : "Ø¹Ø±Ø¶";

  const city = document.getElementById("cityInput").value;
  if (city) getWeather();
}

function formatDate(dateStr) {
  const date = new Date(dateStr);
  if (lang === "fa") {
    return new Intl.DateTimeFormat("fa-IR", {
      weekday: "long", year: "numeric", month: "long", day: "numeric"
    }).format(date);
  } else {
    return new Intl.DateTimeFormat("ar-EG", {
      weekday: "long", year: "numeric", month: "long", day: "numeric"
    }).format(date);
  }
}

async function getWeather() {
  const city = document.getElementById("cityInput").value || "Ø§Ù‡ÙˆØ§Ø²";
  const response = await fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${city}&lang=${lang}&units=metric&appid=${apiKey}`);
  const data = await response.json();

  const daily = document.getElementById("dailyForecast");

  if (data.cod !== "200") {
    daily.innerHTML = lang === "fa" ? "Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª!" : "Ø­Ø¯Ø« Ø®Ø·Ø£!";
    return;
  }

  const days = {};
  data.list.forEach(item => {
    const date = item.dt_txt.split(" ")[0];
    if (!days[date]) days[date] = [];
    days[date].push(item);
  });

  daily.innerHTML = "";
  for (const date in days) {
    const info = days[date][0];
    const maxTemp = Math.max(...days[date].map(d => d.main.temp_max)).toFixed(1);
    const minTemp = Math.min(...days[date].map(d => d.main.temp_min)).toFixed(1);
    const windSpeed = info.wind.speed;
    const windDeg = info.wind.deg;
    const desc = info.weather[0].description;
    const icon = info.weather[0].icon;

    daily.innerHTML += `
      <div class="forecast-card">
        <h3>${formatDate(date)}</h3>
        <img src="https://openweathermap.org/img/wn/${icon}@2x.png" alt="">
        <p>${desc}</p>
        <p>ğŸ”º ${maxTemp}Â° | ğŸ”» ${minTemp}Â°</p>
        <p>ğŸ’¨ ${windSpeed} m/s</p>
        <p>ğŸ§­ ${windDeg}Â°</p>
      </div>
    `;
  }
}

window.onload = () => {
  document.getElementById("cityInput").value = "Ø§Ù‡ÙˆØ§Ø²";
  getWeather();
}
</script>
</body>
</html>
