<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù‡ÙˆØ§Ø´Ù†Ø§Ø³ÛŒ Ø¬Ù‡Ø§Ù†ÛŒ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: sans-serif; background: #f0f8ff; padding: 20px; direction: rtl; text-align: right; }
    .weather-box { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 0 10px #aaa; margin-bottom: 20px; }
    h1, h2 { color: #003366; }
    .icon { width: 60px; vertical-align: middle; }
    .wind-arrow { display: inline-block; transform: rotate(0deg); transition: transform 0.5s; }
    .forecast { display: flex; gap: 10px; overflow-x: auto; padding-top: 10px; }
    .day-box { background: #eef; padding: 10px; border-radius: 10px; min-width: 120px; text-align: center; }
    input[type="text"] { padding: 8px; width: 200px; border-radius: 5px; border: 1px solid #aaa; }
    button { padding: 8px 16px; margin-right: 10px; border-radius: 5px; border: none; background: #0055aa; color: white; cursor: pointer; }
    button:hover { background: #004080; }
  </style>
</head>
<body>

  <h1>Ù‡ÙˆØ§Ø´Ù†Ø§Ø³ÛŒ Ø¬Ù‡Ø§Ù†ÛŒ</h1>
  <div>
    <input type="text" id="cityInput" placeholder="Ù†Ø§Ù… Ø´Ù‡Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ù…Ø«Ù„Ø§Ù‹ Ahvaz)">
    <button onclick="fetchWeather()">Ø¬Ø³ØªØ¬Ùˆ</button>
  </div>

  <div class="weather-box" id="current-weather">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø±Ø§ÛŒ Ø§Ù‡ÙˆØ§Ø²...</div>
  <h2>Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ûµ Ø±ÙˆØ² Ø¢ÛŒÙ†Ø¯Ù‡</h2>
  <div class="forecast" id="forecast"></div>

  <script>
    const apiKey = "dc9c93f51cdd375d459483c2a9f86d88";
    let city = "Ahvaz";
    const lang = "fa";
    const units = "metric";

    async function fetchWeather() {
      const input = document.getElementById("cityInput").value.trim();
      if (input) city = input;

      document.getElementById("current-weather").innerHTML = "Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...";
      document.getElementById("forecast").innerHTML = "";

      try {
        const currentRes = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&lang=${lang}&units=${units}`);
        if (!currentRes.ok) throw new Error("Ø´Ù‡Ø± ÛŒØ§ÙØª Ù†Ø´Ø¯");
        const current = await currentRes.json();

        const forecastRes = await fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${apiKey}&lang=${lang}&units=${units}`);
        const forecast = await forecastRes.json();

        // ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ
        document.getElementById("current-weather").innerHTML = `
          <h3>${current.name}</h3>
          <p><img class="icon" src="https://openweathermap.org/img/wn/${current.weather[0].icon}@2x.png" alt=""> ${current.weather[0].description}</p>
          <p>Ø¯Ù…Ø§: ${current.main.temp}Â°C</p>
          <p>Ø±Ø·ÙˆØ¨Øª: ${current.main.humidity}%</p>
          <p>ÙØ´Ø§Ø±: ${current.main.pressure} hPa</p>
          <p>Ø¨Ø§Ø¯: ${current.wind.speed} m/s 
            <span class="wind-arrow" style="transform: rotate(${current.wind.deg}deg)">ğŸ§­</span>
          </p>
        `;

        // Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ûµ Ø±ÙˆØ² Ø¢ÛŒÙ†Ø¯Ù‡
        const forecastDays = {};
        forecast.list.forEach(item => {
          const date = item.dt_txt.split(" ")[0];
          const hour = item.dt_txt.split(" ")[1];
          if (hour === "12:00:00" && !forecastDays[date]) {
            forecastDays[date] = item;
          }
        });

        const forecastContainer = document.getElementById("forecast");
        for (const date in forecastDays) {
          const day = forecastDays[date];
          forecastContainer.innerHTML += `
            <div class="day-box">
              <p><strong>${new Date(date).toLocaleDateString("fa-IR", { weekday: "long" })}</strong></p>
              <img class="icon" src="https://openweathermap.org/img/wn/${day.weather[0].icon}@2x.png" alt="">
              <p>${day.weather[0].description}</p>
              <p>${day.main.temp.toFixed(1)}Â°C</p>
            </div>
          `;
        }
      } catch (err) {
        document.getElementById("current-weather").innerHTML = `<p style="color:red;">âŒ ${err.message}</p>`;
      }
    }

    fetchWeather(); // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ø±Ø§ÛŒ Ø§Ù‡ÙˆØ§Ø²
  </script>
</body>
</html>
